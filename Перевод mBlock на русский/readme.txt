Перевод с английского на русский не всегда дословен, в некоторых местах дословный перевод искажает смысл, в некоторых местах он не помещается в элементы управления, а местами просто копировал из актуальной версии Скрэтч...

Для выполнения перевода поместить файл в одну папку вместе с файлом локализации mBlock, располагается он обычно по адресу:
C:\Users\Abaddon\AppData\Roaming\com.makeblock.mBlock\Local Store\mBlock\locale\locale.xlsx - это на моем компьютере
Далее открыть excel файл перевода, нажать кнопку "Перевести" вверху страницы и в открывшейся форме нажать кнопку "Выполнить перевод".


На форме перевода для автоматизации выполнил кнопки:
Поиск - найти расположение файла локализации
Искать русский столбец - поиск столбца с русским переводом в файле локализации (иногда от версии к версии столбец меняется, по умолчанию принимает значение J, но можно его изменить вручную).

Поиск файла локализации осуществляется по сопоставлению текущей версии ПО mBlock указанном в файле:
C:\Program Files (x86)\mBlock\META-INF\AIR\application.xml
и соответствующем текущей версии адресу рабочей дирректории ПО mBlock, например для версии 3.4.10 - рабочая папка с расположенным в ней файлом локализации находится здесь:
C:\Users\Abaddon\AppData\Roaming\com.makeblock.Scratch3.4.10\Local Store\mBlock\locale\locale.xlsx - это на моем компьютере
Для разных версий это правило может отличаться, но я не смог найти где в явном виде указывается текущая рабочая директория, поэтому такие костыли...


В разных версиях mBlock может отличаться набор слов для перевода, поэтому добавил галку на включение новых слов в текущий файл локализации, по моим наблюдениям включение лишних слов в базу локализации не влияют на общую работоспособность и порядок расположения слов тоже не важен - поэтому слова добавляются просто в конец списка.


В процессе работы для облегчения анализа и выполнения перевода добавил некоторые сервисные функции:
(Базой или БД везде называю приложенный файл, где хранится сама база перевода и скрипты по переводу)
1.Скопировать перевод в Базу. Здесь копируются все новые слова, не встречающиеся в базе - в конец списка и выделяются цветом, если слова в базе есть и имеющийся в файле локализации перевод отличается от перевода в Базе - то перевод имеющегося слова помещается в столбец правее основного перевода и выделяется цветом.
2.Очистить столбец D. Удаляются слова и очищается цветовое выделение столбца с доп. переводом.
3.Очистить цветовое выделение. Сбрасываются цветовые выделения всех рабочих ячеек, ничего из ячеек не удаляется.
4.Добавить новые слова. Из файла локализации добавляются в конец списка Базы все найденные новые слова с переводом (если есть), если слово уже есть в базе то добавляться оно не будет несмотря на возможную разницу в переводе.
5.Повторения в файле локализации. В файле проводится поиск дубликатов отдельно в английском столбце, отдельно в русском - все повторяющиеся выделяются одним и тем же цветом, файл локализации остается открытым, изменения не сохраняются.
6.Повторения в Базе.В файле проводится поиск дубликатов отдельно в английском столбце, отдельно в русском - все повторяющиеся выделяются одним и тем же цветом.
7.Сортировка по английскому столбцу. Сортировка проводится по всему диапазону рабочих ячеек, т.е. соответствия английских слов и русского перевода сохраняется, порядок слов в базе на функционал не влияют.
8.Сортировка по русскому столбцу. Сортировка проводится по всему диапазону рабочих ячеек, т.е. соответствия английских слов и русского перевода сохраняется, порядок слов в базе на функционал не влияют.

Для отслеживания изменений добавлена кнопка "Сохранить изменения". Кнопка записывает текущую дату\время в первую ячейку столбца "Е" и сохраняет файл.

Никаких защит паролем для доступа к изменениям Базы или скриптов не применял. Кому интересно - проводите доработку Базы своими силами, в скриптах старался всё закомментить - чтобы было понятно. Если сил или желания нет, пишите что добавить (в базу или функционал) - по возможности сделаю.

Все работы по mBlock буду стараться складывать сюда:
https://yadi.sk/d/MmQytgij3MnhSy

Почта:
whoamy@yandex.ru
